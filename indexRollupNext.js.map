{"version":3,"file":"indexRollupNext.js","sources":["src/Annotation.js","src/AnnotationCollection.js","src/Handles.js","src/Note/alignment.js","src/Builder.js","src/Note/lineType-vertical.js","src/Note/lineType-horizontal.js","src/Connector/type-line.js","src/Connector/type-elbow.js","src/Connector/type-curve.js","src/Connector/end-arrow.js","src/Connector/end-dot.js","src/Subject/circle.js","src/Subject/rect.js","src/Subject/threshold.js","src/Subject/badge.js","src/Types-d3.js","src/Adapter-d3.js","index.js"],"sourcesContent":["\nexport default class Annotation {\n  constructor({ x=0, y=0, dy=0, dx=0, data, type, subject, connector, note, \n    disable, id, className }) {\n\n    this._dx = dx\n    this._dy = dy \n    this._x = x \n    this._y = y\n    this.id = id\n    this._className = className || ''\n\n    this.type = type || ''\n    this.data = data\n\n    this.note = note || {}\n    this.connector = connector || {}\n    this.subject = subject || {}\n\n    this.disable = disable || []\n  }\n\n  updatePosition(){\n    if (this.type.setPosition) { \n      this.type.setPosition() \n      if (this.type.subject.selectAll(':not(.handle)').nodes().length !== 0) {\n        this.type.redrawSubject()\n      }\n    }\n  }\n\n  get className() { return this._className }\n\n  set className(className){\n    this._className = className\n    if (this.type.setClassName) this.type.setClassName()\n  }\n\n  updateOffset(){\n    if (this.type.setOffset) {\n      this.type.setOffset() \n            \n      if (this.type.connector.selectAll(':not(.handle)').nodes().length !== 0) {\n        this.type.redrawConnector()\n      }\n\n      this.type.redrawNote()\n    }\n  }\n\n  get x() { return this._x }\n  set x(x) { \n    this._x = x; \n    this.updatePosition()\n  }\n\n  get y() { return this._y }\n  set y(y) { \n    this._y = y; \n    this.updatePosition()\n  }\n\n  get dx() { return this._dx }\n  set dx(dx) { \n    this._dx = dx; \n    this.updateOffset()\n  }\n\n  get dy() { return this._dy }\n  set dy(dy) { \n    this._dy = dy; \n    this.updateOffset()\n  }\n\n  get offset() { return { x: this._dx, y: this._dy }}\n\n  set offset({ x, y }) {\n    this._dx = x\n    this._dy = y\n    this.updateOffset()\n  }\n\n  get position() { return { x: this._x, y: this._y }}\n\n  set position({ x, y }) {\n    this._x = x\n    this._y = y\n    this.updatePosition()\n  }\n\n  get translation() {\n    return {\n    x: this._x + this._dx,\n    y: this._y + this._dy\n  }}\n\n  get json() { \n    const json = {\n      x: this._x,\n      y: this._y,\n      dx: this._dx,\n      dy: this._dy\n    }\n\n    if (this.data && Object.keys(this.data).length > 0) json.data = this.data\n    if (this.type) json.type = this.type\n    if (this._className) json.className = this._className\n\n    if (Object.keys(this.connector).length > 0) json.connector = this.connector\n    if (Object.keys(this.subject).length > 0) json.subject = this.subject\n    if (Object.keys(this.note).length > 0) json.note = this.note\n    \n    return json\n  }\n}","export default class AnnotationCollection {\n\n  constructor({ annotations, accessors, accessorsInverse }) {\n    this.accessors = accessors\n    this.accessorsInverse = accessorsInverse\n    this.annotations = annotations\n  }\n\n  clearTypes(newSettings) {\n    this.annotations.forEach(d => {\n      d.type = undefined\n      d.subject = newSettings && newSettings.subject || d.subject\n      d.connector = newSettings && newSettings.connector || d.connector\n      d.note = newSettings && newSettings.note || d.note\n    })\n  }\n\n  setPositionWithAccessors() {\n    this.annotations.forEach(d => {\n      d.type.setPositionWithAccessors(this.accessors)\n    })\n  }\n\n  editMode(editMode) { this.annotations.forEach(a => {\n      if (a.type) {\n        a.type.editMode = editMode\n        a.type.updateEditMode()\n      }\n    })\n  }\n\n  updateDisable(disable) {\n    this.annotations.forEach(a => {\n      a.disable = disable\n      if (a.type){\n        disable.forEach(d => {\n          if (a.type[d]){\n          a.type[d].remove && a.type[d].remove()\n          a.type[d] = undefined\n          }\n        })\n      }\n    })\n  }\n\n  updateTextWrap(textWrap) {\n    this.annotations.forEach(a => {\n      if (a.type && a.type.updateTextWrap){\n        a.type.updateTextWrap(textWrap)\n      }\n    })\n  }\n\n  updateNotePadding(notePadding) {\n    this.annotations.forEach(a => {\n      if (a.type){\n        a.type.notePadding = notePadding\n      }\n    })\n  }\n\n  get json() { \n    return this.annotations.map(a => {      \n      const json = a.json\n      if (this.accessorsInverse && a.data){\n        json.data = {}\n        Object.keys(this.accessorsInverse).forEach(k => {\n          json.data[k] = this.accessorsInverse[k]({ x: a.x, y: a.y})\n\n          //TODO make this feasible to map back to data for other types of subjects\n        })\n      }\n      return json\n    })\n  }\n\n  get noteNodes(){\n    return this.annotations.map(a => ({ ...a.type.getNoteBBoxOffset(), positionX: a.x, positionY: a.y }))\n  }\n\n  //TODO: come back and rethink if a.x and a.y are applicable in all situations\n  // get connectorNodes() {\n  //   return this.annotations.map(a => ({ ...a.type.getConnectorBBox(), startX: a.x, startY: a.y}))\n  // }\n\n  // get subjectNodes() {\n  //   return this.annotations.map(a => ({ ...a.type.getSubjectBBox(), startX: a.x, startY: a.y}))\n  // }\n\n  // get annotationNodes() {\n  //   return this.annotations.map(a => ({ ...a.type.getAnnotationBBox(), startX: a.x, startY: a.y}))\n  // }\n}\n","import { select } from 'd3-selection'\nimport { drag } from 'd3-drag'\n\n\nexport const pointHandle = ({ cx=0, cy=0 }) => {\n  return { move: { x: cx, y: cy} }\n}\n\nexport const circleHandles = ({ cx=0, cy =0, r1, r2, padding }) => {\n  const h = { move: { x: cx, y: cy}}\n       \n  if (r1 !== undefined) {\n    h.r1 = { x: cx + r1/Math.sqrt(2), y: cy + r1/Math.sqrt(2) }\n  }\n  \n  if (r2 !== undefined) {\n    h.r2 = { x: cx + r2/Math.sqrt(2), y: cy + r2/Math.sqrt(2) }\n  }\n\n  if (padding !== undefined) {\n    h.padding = { x: cx + r1 + padding, y: cy}\n  }\n\n  return h\n}\n\nexport const rectHandles = ({ x1=0, y1=0, x2=x1, y2=y1, width, height }) => {\n  \n  const w = width || Math.abs(x2 - x1)\n  const h = height || Math.abs(y2 - y1)\n\n  return {\n    move: {\n      x: Math.min(x1, x2) + w/2,\n      y: Math.min(y1, y2) - 10\n    },\n    width: {\n      x: Math.max(x1, x2),\n      y: Math.min(y1, y2) + h/2\n    },\n    height: {\n      x: Math.min(x1, x2) + w/2,\n      y: Math.max(y1, y2)\n    }\n  }\n}\n\nexport const lineHandles = ({ x1, y1, x2, y2, x, y}) => {\n\n  const minY = Math.min(y1, y2)\n  const minX = Math.min(x1, x2)\n\n  const height = Math.abs(y2 - y1)\n  const width = Math.abs(x2 - x1)\n  \n  return {\n    move: {\n      x: x || minX + width/2,\n      y: y || minY + height/2\n    }\n  }\n}\n\n//arc handles\nexport const addHandles = ({ group, handles, r=10}) => { \n   //give it a group and x,y to draw handles\n   //then give it instructions on what the handles change \n   const h = group.selectAll('circle.handle')\n    .data(handles)\n\n  h.enter()\n    .append('circle')\n    .attr('class', 'handle')\n    .call(drag()\n      .container(select('g.annotations').node())\n      .on('start', d => d.start && d.start(d))\n      .on('drag', d => d.drag && d.drag(d))\n      .on('end', d => d.end && d.end(d))\n    )\n\n  group.selectAll('circle.handle')\n    .attr('cx', d => d.x)\n    .attr('cy', d => d.y)\n    .attr('r', d => d.r || r)\n    .attr('class', d => `handle ${d.className || ''}`)\n\n  h.exit()\n    .remove()\n    \n}\n\n","\nexport const leftRightDynamic = (align, y) => {\n  if (align == \"dynamic\" || align == \"left\" || align == \"right\"){\n      if (y < 0){ align = \"top\" }\n      else { align = \"bottom\" } \n  }\n  return align\n}\n\nexport const topBottomDynamic = (align, x) => {\n  if (align == \"dynamic\" || align == \"top\" || align == \"bottom\"){\n    if (x < 0){ align = \"right\" }\n    else { align = \"left\" }      \n  }\n  return align\n}\n\n\nexport default ({ padding, bbox, align, orientation, offset }) => {\n    let x = -bbox.x \n    let y = -bbox.y\n\n   if ( orientation === \"topBottom\" ){\n      align = topBottomDynamic(align, offset.x)\n      if (offset.y < 0){ \n        y -= (bbox.height + padding)\n     } else {\n       y += padding\n     }\n\n      if ( align === \"middle\" ) {\n        x -= bbox.width/2\n      } else if (align === \"right\" ) {\n        x -= (bbox.width)\n      } \n\n    } else if ( orientation === \"leftRight\" ){\n      align = leftRightDynamic(align, offset.y)\n      if (offset.x < 0){ \n        x -= (bbox.width + padding) \n      } else {\n        x += padding\n      }\n\n       if ( align === \"middle\" ) {\n          y -= bbox.height/2\n       } else if (align === \"top\" ){\n          y -= (bbox.height )\n       }\n    } \n\n    return { x, y }\n}","import { line, arc, curveLinear, symbol, symbolTriangle } from \"d3-shape\"\n\nexport const lineBuilder = ({ data, curve=curveLinear, canvasContext, className }) => { \n  const lineGen = line()\n    .curve(curve)\n\n  const builder = {\n    type: 'path',\n    className,\n    data\n  }\n\n  if (canvasContext) {\n    lineGen.context(canvasContext)\n    builder.pathMethods = lineGen\n\n  } else {\n    builder.attrs = {\n      d: lineGen(data)\n    }\n  }\n\n  return builder\n}\n\nexport const arcBuilder = ({ data, canvasContext, className }) => {\n\n  const builder = {\n    type: 'path',\n    className,\n    data\n  }\n\n  const arcShape = arc()\n    .innerRadius(data.innerRadius || 0)\n    .outerRadius(data.outerRadius || data.radius || 2)\n    .startAngle(data.startAngle || 0)\n    .endAngle(data.endAngle || 2*Math.PI)\n\n  if (canvasContext) {\n    arcShape.context(canvasContext)\n    builder.pathMethods = lineGen\n\n  } else {\n    \n    builder.attrs = {\n      d: arcShape()\n    }\n  }\n\n  return builder\n}","import { lineBuilder } from '../Builder'\nimport { leftRightDynamic } from './alignment'\n\nexport default ({ align, x=0, y=0, bbox, offset, padding }) => {\n  align = leftRightDynamic(align, offset.y)\n\n  if (align == \"top\") { y -= bbox.height } \n  else if (align == \"middle\"){ y -= bbox.height/2 }\n\n  const data = [[x, y], [x, y + bbox.height]]\n  return { components: [lineBuilder({ data, className : \"note-line\" })] }\n}","import { lineBuilder } from '../Builder'\nimport { topBottomDynamic } from './alignment'\n\nexport default ({ align, x=0, y=0, offset, bbox, padding }) => {\n  align = topBottomDynamic(align, offset.x)\n\n  if (align == \"right\") { x -= bbox.width }\n  else if (align == \"middle\"){ x -= bbox.width/2 }\n\n  const data = [[x, y], [x + bbox.width, y]]\n  return { components: [lineBuilder({ data, className : \"note-line\" })] }\n}","import { lineBuilder } from '../Builder'\n\nexport const lineSetup = ({ type, subjectType }) => {\n  let annotation = type.annotation\n  let offset = annotation.position\n  \n  let x1 = annotation.x - offset.x,\n    x2 = x1 + annotation.dx,\n    y1 = annotation.y - offset.y,\n    y2 = y1 + annotation.dy\n\n\n const subjectData = annotation.subject\n\n  if (subjectType == \"circle\" && (subjectData.outerRadius || subjectData.radius)){\n    const h =  Math.sqrt((x1 - x2)*(x1 - x2) + (y1 - y2)*(y1 - y2))\n    const angle = Math.asin(-y2/h)\n    const r = subjectData.outerRadius || subjectData.radius + (subjectData.radiusPadding || 0)\n\n    x1 = Math.abs(Math.cos(angle)*r)*(x2 < 0 ? -1 : 1)\n    y1 = Math.abs(Math.sin(angle)*r)*(y2 < 0 ? -1 : 1)\n\n  }\n\n  if (subjectType == \"rect\"){\n      const { width, height } = subjectData\n      \n      if ((width > 0 && annotation.dx > 0) || (width < 0 && annotation.dx < 0)) {\n          if (Math.abs(width) > Math.abs(annotation.dx)) x1 = width/2\n          else x1 = width\n      } \n      if ((height > 0 && annotation.dy > 0) || (height < 0 && annotation.dy < 0)) {\n          if (Math.abs(height) > Math.abs(annotation.dy)) y1 = height/2\n          else y1 = height\n      }\n      if (x1 == width/2 && y1 == height/2){ x1 = x2; y1 = y2;}\n    }\n\n\n  return [[x1, y1], [x2, y2]]\n}\n\nexport default (connectorData) => {\n  const data = lineSetup(connectorData)\n  return { components: [lineBuilder({ data, className : \"connector\" })]} \n}","import { lineBuilder } from '../Builder'\n\nexport default ({ type, subjectType }) => {\n\n    const annotation = type.annotation\n    const offset = annotation.position\n\n    let x1 = annotation.x - offset.x,\n    x2 = x1 + annotation.dx,\n    y1 = annotation.y - offset.y,\n    y2 = y1 + annotation.dy\n\n    const subjectData = annotation.subject\n\n    if (subjectType == \"rect\"){\n      const { width, height } = subjectData\n      \n      if ((width > 0 && annotation.dx > 0) || (width < 0 && annotation.dx < 0)) {\n          if (Math.abs(width) > Math.abs(annotation.dx)) x1 = width/2\n          else x1 = width\n      } \n      if ((height > 0 && annotation.dy > 0) || (height < 0 && annotation.dy < 0)) {\n          if (Math.abs(height) > Math.abs(annotation.dy)) y1 = height/2\n          else y1 = height\n      }\n      if (x1 == width/2 && y1 == height/2){ x1 = x2; y1 = y2;}\n    }\n\n    let data = [[x1, y1], [x2, y2]]\n\n    let diffY = (y2 - y1)\n    let diffX = (x2 - x1)\n    let xe = x2 \n    let ye = y2\n    let opposite = (y2 < y1 && x2 > x1 || x2 < x1 && y2 > y1)? -1 : 1\n\n    if (Math.abs(diffX) < Math.abs(diffY)){\n      xe = x2\n      ye = y1 + diffX*opposite\n    } else {\n      ye = y2\n      xe = x1 + diffY*opposite\n    }\n    \n    if (subjectType == \"circle\" && (subjectData.outerRadius || subjectData.radius)){\n      const r = (subjectData.outerRadius || subjectData.radius) + (subjectData.radiusPadding || 0)\n      const length = r/Math.sqrt(2)\n\n      if (Math.abs(diffX) > length && Math.abs(diffY) > length){\n        x1 = length*(x2 < 0 ? -1 : 1)\n        y1 = length*(y2 < 0 ? -1 : 1)\n        data = [[x1, y1], [xe , ye ], [x2, y2]]\n\n      } else if (Math.abs(diffX) > Math.abs(diffY)){\n        const angle = Math.asin(-y2/r)\n        x1 = Math.abs(Math.cos(angle)*r)*(x2 < 0 ? -1 : 1)\n        data = [[ x1, y2], [x2, y2]]\n      } else {\n        const angle = Math.acos(x2/r)\n        y1 = Math.abs(Math.sin(angle)*r)*(y2 < 0 ? -1 : 1)\n        data = [[ x2, y1], [x2, y2]]\n      }\n    } else {\n      data = [[x1, y1], [xe , ye], [x2, y2]]\n    }\n\n    return { components: [lineBuilder({ data, className: \"connector\"})]}\n}\n","import { lineBuilder } from '../Builder'\nimport { event } from 'd3-selection'\nimport { lineSetup } from './type-line'\nimport { curveCatmullRom } from 'd3-shape'\nimport { pointHandle } from '../Handles'\n\nexport default ({ type, connectorData, subjectType }) => {\n\n  if (!connectorData){ connectorData = {} }\n  if (!connectorData.points || typeof connectorData.points === \"number\"){ \n    connectorData.points = createPoints(type.annotation.offset, connectorData.points) \n  }\n  if (!connectorData.curve){ connectorData.curve = curveCatmullRom }\n\n  let handles = []\n\n  if (type.editMode) {\n    const cHandles = connectorData.points\n      .map((c,i) => ({...pointHandle({cx: c[0], cy: c[1]}), index: i}))\n\n    const updatePoint = (index) => {      \n        connectorData.points[index][0] += event.dx\n        connectorData.points[index][1] += event.dy\n        type.redrawConnector()\n    }\n  \n    handles = type.mapHandles(cHandles\n      .map(h => ({ ...h.move, drag: updatePoint.bind(type, h.index)})))\n\n  }\n\n  let data = lineSetup({ type, subjectType })\n  data = [data[0], ...connectorData.points, data[1]]\n  const components = [lineBuilder({ data, curve: connectorData.curve, className: \"connector\" })]\n\n  return { components , handles }\n}\n\nconst createPoints = function( offset, anchors=2){\n  const diff = { x: offset.x/(anchors + 1), y: offset.y/(anchors + 1) }\n  const p = []\n\n  let i = 1 \n  for (; i <= anchors; i++){\n    p.push([diff.x*i + i%2*20, diff.y*i - i%2*20])\n  }\n  return p\n}","import { lineBuilder } from '../Builder'\n\nexport default ({ annotation, start, end }) => {\n  const offset = annotation.position\n  if (!start) { start = [annotation.dx, annotation.dy]} \n  else { start = [-end[0] + start[0], - end[1] + start[1]]}\n  if (!end) { end = [annotation.x - offset.x, annotation.y - offset.y]}\n\n  let x1 = end[0],\n    y1 = end[1];\n\n  let dx = start[0] \n  let dy = start[1] \n\n  let size = 10;\n  let angleOffset = 16/180*Math.PI\n  let angle = Math.atan(dy/dx) \n\n  if (dx < 0 ) {\n    angle += Math.PI\n  }\n\n  const data = [[x1, y1], \n    [Math.cos(angle + angleOffset)*size + x1, Math.sin(angle + angleOffset)*size + y1],\n    [Math.cos(angle - angleOffset)*size + x1, Math.sin(angle - angleOffset)*size + y1],\n    [x1, y1]]\n\n  //TODO add in reverse\n  // if (canvasContext.arrowReverse){\n  //   data = [[x1, y1], \n  //   [Math.cos(angle + angleOffset)*size, Math.sin(angle + angleOffset)*size],\n  //   [Math.cos(angle - angleOffset)*size, Math.sin(angle - angleOffset)*size],\n  //   [x1, y1]\n  //   ]\n  // } else {\n  //   data = [[x1, y1], \n  //   [Math.cos(angle + angleOffset)*size, Math.sin(angle + angleOffset)*size],\n  //   [Math.cos(angle - angleOffset)*size, Math.sin(angle - angleOffset)*size],\n  //   [x1, y1]\n  //   ]\n  // }\n\n  return { components: [lineBuilder({ data, className : 'connector-arrow' })] }\n}\n","import { arcBuilder } from '../Builder'\n\nexport default ({ line }) => {\n  \n  let dot = arcBuilder({ className: 'connector-dot', data: { radius: 3} })\n  dot.attrs.transform = `translate(${line.data[0][0]}, ${line.data[0][1]})`\n  \n  return { components: [dot] }\n}\n","import { circleHandles } from '../Handles'\nimport { arcBuilder } from '../Builder'\nimport { event } from 'd3-selection'\n\nexport default ({ subjectData, type}) => {\n    if (!subjectData.radius && !subjectData.outerRadius ){ subjectData.radius = 20 }\n\n    let handles = []\n    const c = arcBuilder({ data: subjectData, className: \"subject\" })\n    if (type.editMode){\n      const h = circleHandles({\n        r1: c.data.outerRadius || c.data.radius,\n        r2: c.data.innerRadius,\n        padding: subjectData.radiusPadding\n      })\n\n      const updateRadius = (attr) => {      \n        const r = subjectData[attr] + event.dx*Math.sqrt(2)\n        subjectData[attr] = r\n        type.redrawSubject()\n        type.redrawConnector()\n      }\n\n      const cHandles = [\n        { ...h.r1, drag: updateRadius.bind(type, subjectData.outerRadius !== undefined ? 'outerRadius': 'radius')}\n        ]\n\n      if (subjectData.innerRadius){\n        cHandles.push({ ...h.r2, drag: updateRadius.bind(type, 'innerRadius')})\n      }\n      handles = type.mapHandles(cHandles)\n    }\n\n    return { components: [c], handles }\n}","import { circleHandles } from '../Handles'\nimport { lineBuilder } from '../Builder'\nimport { event } from 'd3-selection'\n\nexport default ({ subjectData, type}) => {\n    if (!subjectData.width){ subjectData.width = 100 }\n    if (!subjectData.height){ subjectData.height = 100 }\n\n    let handles = []\n    let { width, height } = subjectData\n\n    const data = [[0, 0], \n      [ width, 0], \n      [ width, height], \n      [0, height],\n      [0, 0]]\n    let rect = lineBuilder({ data, className : 'subject'})\n\n    if (type.editMode){\n\n      const updateWidth = (attr) => {  \n        subjectData.width = event.x\n        type.redrawSubject()\n        type.redrawConnector()\n      }\n\n      const updateHeight = () => {\n        subjectData.height = event.y\n        type.redrawSubject()\n        type.redrawConnector()\n      }\n\n      const rHandles = [{ x: width, y: height/2, drag: updateWidth.bind(type) },\n        { x: width/2, y: height, drag: updateHeight.bind(type) }\n      ]\n\n      handles = type.mapHandles(rHandles)\n\n    }\n\n    return { components: [rect], handles }\n}","import { circleHandles } from '../Handles'\nimport { lineBuilder } from '../Builder'\n\n\nexport default ({ subjectData, type }) => {\n  const offset = type.annotation.position\n\n  let x1 = (subjectData.x1 !== undefined ? subjectData.x1 : offset.x) - offset.x,\n    x2 = (subjectData.x2 !== undefined ? subjectData.x2 : offset.x) - offset.x,\n    y1 = (subjectData.y1 !== undefined ? subjectData.y1 : offset.y) - offset.y,\n    y2 = (subjectData.y2 !== undefined ? subjectData.y2 : offset.y) - offset.y\n\n  const data = [[x1, y1], [x2, y2]]\n  return { components: [lineBuilder({ data, className : 'subject'})]}\n}","import { circleHandles } from '../Handles'\nimport { lineBuilder, arcBuilder } from '../Builder'\nimport { event } from 'd3-selection'\n\nexport default ({ subjectData, type }) => {\n  if (!subjectData.radius ) subjectData.radius = 14\n  if (!subjectData.x) subjectData.x =\"left\"\n  if (!subjectData.y) subjectData.y = \"top\"\n\n  let handles = []\n  const radius = subjectData.radius\n  const innerRadius = radius*.7\n  const x = subjectData.x == \"left\" ? -radius : radius\n  const y = subjectData.y == \"top\" ? -radius : radius\n  const transform = `translate(${x}, ${y})`\n  const circlebg = arcBuilder({ className: 'subject', data: { radius} }) \n  circlebg.attrs.transform = transform\n\n  const circle = arcBuilder({ className: 'subject-ring', data: { outerRadius: radius, innerRadius} })\n  circle.attrs.transform = transform\n\n  const pointer = lineBuilder({ className: 'subject-pointer',\n    data: [[0, 0], [x, 0], [0, y], [0, 0]]\n  })\n\n  if (type.editMode){\n\n    const dragBadge = () => {\n      subjectData.x = event.x < 0 ? \"left\" : \"right\"\n      subjectData.y = event.y < 0 ? \"top\" : \"bottom\"\n      type.redrawSubject()\n    }\n\n    const bHandles = [{ x: x*2, y: y*2, drag: dragBadge.bind(type)}]\n    handles = type.mapHandles(bHandles)\n\n  }\n\n  let text\n  if (subjectData.text){\n    text = {\n      type: \"text\",\n      className: \"badge-text\",\n      attrs: {\n        text: subjectData.text,\n        \"text-anchor\": \"middle\",\n        dy: \".25em\",\n        x,\n        y\n      }\n    }\n  }\n  return { components: [pointer, circlebg, circle, text], handles }\n}","import { select, event } from 'd3-selection'\nimport { drag } from 'd3-drag'\nimport { addHandles } from './Handles'\n\n//Note options\nimport noteAlignment from './Note/alignment'\nimport noteVertical from './Note/lineType-vertical'\nimport noteHorizontal from './Note/lineType-horizontal'\n\n//Connector options\nimport connectorLine from './Connector/type-line'\nimport connectorElbow from './Connector/type-elbow'\nimport connectorCurve from './Connector/type-curve'\nimport connectorArrow from './Connector/end-arrow'\nimport connectorDot from './Connector/end-dot'\n\n//Subject options\nimport subjectCircle from './Subject/circle'\nimport subjectRect from './Subject/rect'\nimport subjectThreshold from './Subject/threshold'\nimport subjectBadge from './Subject/badge'\n\nexport class Type {\n  constructor({ a, annotation, editMode, dispatcher, notePadding, accessors }) {\n    this.a = a\n\n    this.note = annotation.disable.indexOf(\"note\") === -1 && a.select('g.annotation-note')\n    this.noteContent = this.note && a.select('g.annotation-note-content')\n    this.connector = annotation.disable.indexOf(\"connector\") === -1 && a.select('g.annotation-connector')\n    this.subject = annotation.disable.indexOf(\"subject\") === -1 && a.select('g.annotation-subject')\n\n    if (dispatcher){\n      const handler = addHandlers.bind(null, dispatcher, annotation)\n      handler({ component: this.note, name: 'note' })\n      handler({ component: this.connector, name: 'connector' })\n      handler({ component: this.subject, name: 'subject' })\n    }\n  \n    this.annotation = annotation\n    this.editMode = annotation.editMode || editMode\n    this.notePadding = notePadding || 3\n    this.offsetCornerX = 0\n    this.offsetCornerY = 0\n\n    if (accessors && annotation.data){\n      this.init(accessors)\n    }\n  }\n\n  init(accessors) {\n    if (!this.annotation.x){\n      this.mapX(accessors)\n    }\n    if (!this.annotation.y){\n      this.mapY(accessors)\n    }\n  }\n\n  mapY(accessors){\n    if (accessors.y){\n      this.annotation.y = accessors.y(this.annotation.data)\n    }\n  }\n\n  mapX(accessors) {\n    if (accessors.x){\n      this.annotation.x = accessors.x(this.annotation.data)\n    }\n  }\n\n\n  updateEditMode () {\n    this.a.selectAll('circle.handle')\n      .remove()\n  }\n\n  drawOnSVG (component, builders) {\n    if (!Array.isArray(builders)){\n      builders = [ builders ]\n    }\n\n    builders\n      .filter(b => b)\n      .forEach(({ type, className, attrs, handles}) => {\n        if (type === \"handle\"){\n          addHandles({ group: component, r: attrs && attrs.r, handles })\n        } else {\n          newWithClass(component, [this.annotation], type, className)\n          \n          const el = component.select(`${type}.${className}`) \n          const attrKeys = Object.keys(attrs)\n          attrKeys.forEach(attr => {\n            if (attr === \"text\"){\n              el.text(attrs[attr])\n            } else {\n              el.attr(attr, attrs[attr])\n            }\n          })\n        }\n      })\n  }\n\n  //TODO: how to extend this to a drawOnCanvas mode? \n\n  getNoteBBox() { return bboxWithoutHandles(this.note, '.annotation-note-content text')}\n  getNoteBBoxOffset() { \n    const bbox = bboxWithoutHandles(this.note, '.annotation-note-content')\n    const transform = this.noteContent.attr('transform').split(/\\(|\\,|\\)/g)\n    bbox.offsetCornerX = parseFloat(transform[1]) + this.annotation.dx\n    bbox.offsetCornerY = parseFloat(transform[2]) + this.annotation.dy\n    bbox.offsetX = this.annotation.dx\n    bbox.offsetY = this.annotation.dy\n    return bbox \n  }\n\n  // getConnectorBBox() { return bboxWithoutHandles(this.connector)}\n  // getSubjectBBox() { return bboxWithoutHandles(this.subject)}\n  // getAnnotationBBox() { return bboxWithoutHandles(this.a)}\n\n  drawSubject (context={}) {\n    const subjectData = this.annotation.subject\n    const type = context.type\n    const subjectParams = { type: this, subjectData}\n\n    let subject = {}\n    if (type === \"circle\") subject = subjectCircle(subjectParams)\n    else if (type === \"rect\") subject = subjectRect(subjectParams)\n    else if (type === \"threshold\") subject = subjectThreshold(subjectParams)\n    else if (type === \"badge\") subject = subjectBadge(subjectParams)\n\n    let { components=[], handles=[] } = subject\n    if (this.editMode){\n      handles = handles.concat(this.mapHandles([{ drag: this.dragSubject.bind(this)}]))\n      components.push({ type: \"handle\", handles })\n    }\n\n    return components\n }\n\n  drawConnector (context={}) {\n    const connectorData = this.annotation.connector\n    const type = connectorData.type || context.type\n    const connectorParams = { type: this, connectorData}\n    connectorParams.subjectType = this.typeSettings && this.typeSettings.subject && this.typeSettings.subject.type \n\n    let connector = {}\n    if (type === \"curve\") connector = connectorCurve(connectorParams)\n    else if (type === \"elbow\") connector = connectorElbow(connectorParams)\n    else connector = connectorLine(connectorParams)\n\n    let { components=[], handles=[] } = connector\n    const line = components[0]\n    const endType = connectorData.end || context.end\n    let end = {}\n    if (endType === \"arrow\") {\n      let s = line.data[1]\n      const e = line.data[0]\n      const distance = Math.sqrt(Math.pow((s[0] - e[0]),2) + Math.pow((s[1] - e[1]),2))\n      if (distance < 5 && line.data[2]) {\n        s = line.data[2]\n      }\n\n      end = connectorArrow({ annotation: this.annotation, start: s, end: e })\n    } else if (endType === \"dot\") {\n      end = connectorDot({ line })\n    }\n\n    if (end.components){ components = components.concat(end.components)}\n\n    if (this.editMode){\n      if (handles.length !== 0) components.push({ type: \"handle\", handles })\n    }\n    return components;\n  }\n\n  drawNote (context={}) {\n    const noteData = this.annotation.note\n    const align = noteData.align || context.align || 'dynamic'\n    const noteParams = { bbox: context.bbox, align, offset: this.annotation.offset }\n    const lineType = noteData.lineType || context.lineType\n    let note={}\n    if (lineType == \"vertical\") note = noteVertical(noteParams)\n    else if (lineType == \"horizontal\") note = noteHorizontal(noteParams)\n\n    let { components=[], handles=[] } = note\n    if (this.editMode) {\n      handles = this.mapHandles([{ x: 0, y: 0, drag: this.dragNote.bind(this)}])\n      components.push({ type: \"handle\", handles })\n    }\n    return components\n  }\n\n  drawNoteContent (context) {\n    const noteData = this.annotation.note\n    const padding = noteData.padding || this.notePadding\n    let orientation = noteData.orientation || context.orientation || 'topBottom'\n    const lineType = noteData.lineType || context.lineType\n    const align = noteData.align || context.align || 'dynamic'\n    const subjectType = this.typeSettings && this.typeSettings.subject && this.typeSettings.subject.type \n    \n    if (lineType == \"vertical\") orientation =  \"leftRight\"\n    else if (lineType == \"horizontal\") orientation = \"topBottom\"\n\n    const noteParams = { padding, bbox: context.bbox, offset: \n    this.annotation.offset, orientation, align }\n\n    const { x, y } = noteAlignment(noteParams)\n    this.offsetCornerX = x + this.annotation.dx\n    this.offsetCornerY = y + this.annotation.dy\n    this.note && this.noteContent.attr('transform', `translate(${x}, ${y})`)\n    \n    return []\n  } \n\n  drawOnScreen(component, drawFunction) { return this.drawOnSVG( component, drawFunction) }\n\n  redrawSubject(){\n    this.subject && this.drawOnScreen( this.subject, this.drawSubject())\n  }\n\n  redrawConnector(bbox=this.getNoteBBox()){\n    this.connector && this.drawOnScreen( this.connector, this.drawConnector())\n  }\n\n  redrawNote(bbox=this.getNoteBBox()){\n    this.noteContent && this.drawOnScreen( this.noteContent, this.drawNoteContent({ bbox }))\n    this.note && this.drawOnScreen( this.note, this.drawNote({ bbox }))  \n  }\n\n  setPosition(){\n    const position = this.annotation.position \n    this.a.attr('transform', `translate(${position.x}, ${position.y})`)\n  }\n\n  setOffset(){\n    if (this.note){\n      const offset = this.annotation.offset\n      this.note.attr('transform', `translate(${offset.x}, ${offset.y})`)\n    }\n  }\n\n  setPositionWithAccessors(accessors){\n    if (accessors && this.annotation.data){\n      this.mapX(accessors)\n      this.mapY(accessors)\n    }\n    this.setPosition()\n  }\n\n\n  setClassName(){\n    this.a.attr(\"class\", `annotation ${this.className && this.className()} ${this.editMode ? \"editable\" : \"\"} ${this.annotation.className || ''}`)\n  }\n\n  draw() {\n    this.setClassName()\n    this.setPosition()\n    this.setOffset()\n    this.redrawSubject()\n    this.redrawConnector()\n    this.redrawNote()\n  }\n\n  dragstarted() { event.sourceEvent.stopPropagation(); \n    this.a.classed(\"dragging\", true) \n    this.a.selectAll(\"circle.handle\").style(\"pointer-events\", \"none\")\n  }\n  dragended() { \n    this.a.classed(\"dragging\", false)\n    this.a.selectAll(\"circle.handle\").style(\"pointer-events\", \"all\")\n  }\n\n  dragSubject() {\n    const position = this.annotation.position\n    position.x += event.dx\n    position.y += event.dy\n    this.annotation.position = position\n  }\n\n  dragNote() {\n    const offset = this.annotation.offset\n    offset.x += event.dx\n    offset.y += event.dy\n    this.annotation.offset = offset\n  }\n\n  mapHandles(handles) {\n    return handles\n    .map(h => ({ ...h, \n      start: this.dragstarted.bind(this), end: this.dragended.bind(this) }))\n  }\n}\n\nexport const customType = (initialType, typeSettings, init) => {\n  return class customType extends initialType {\n    constructor (settings) {\n      super(settings)\n      this.typeSettings = typeSettings\n\n      if (typeSettings.disable){\n        typeSettings.disable.forEach(d => {\n          this[d] = undefined\n          if (d == \"note\"){\n            this.noteContent = undefined\n          }\n        })\n      }\n    }\n\n    static init(annotation, accessors){ \n      super.init(annotation, accessors); \n      if (init) {\n        annotation = init(annotation, accessors) \n      }\n      return annotation\n    }\n\n    className(){ return `${typeSettings.className || ''} ${super.className && super.className() || ''}`}\n\n    drawSubject(context){\n       this.typeSettings.subject = Object.assign({}, typeSettings.subject, this.typeSettings.subject)\n       return super.drawSubject({ ...context, ...this.typeSettings.subject })\n    }\n\n    drawConnector(context, subjectContext){\n      this.typeSettings.connector = Object.assign({}, typeSettings.connector, this.typeSettings.connector)\n      return super.drawConnector({ ...context, ...typeSettings.connector, ...this.typeSettings.connector })\n    }\n\n    drawNote(context){\n      this.typeSettings.note = Object.assign({}, typeSettings.note, this.typeSettings.note)\n      return super.drawNote({ ...context, ...typeSettings.note, ...this.typeSettings.note })\n    }\n\n    drawNoteContent(context){\n      return super.drawNoteContent({ ...context, ...typeSettings.note, ...this.typeSettings.note })\n    }\n  }\n}\n\nexport class d3NoteText extends Type {\n\n  constructor(params){\n    super(params)\n    this.textWrap = params.textWrap || 120\n    this.drawText()\n  }\n\n  updateTextWrap (textWrap) {\n    this.textWrap = textWrap\n    this.drawText()\n  }\n\n  //TODO: add update text functionality\n\n  drawText () {\n    if (this.note){\n      \n      newWithClass(this.note, [this.annotation], 'g', 'annotation-note-content')\n\n      const noteContent = this.note.select('g.annotation-note-content')\n      newWithClass(noteContent, [this.annotation], 'rect', 'annotation-note-bg')\n      newWithClass(noteContent, [this.annotation], 'text', 'annotation-note-label')\n      newWithClass(noteContent, [this.annotation], 'text', 'annotation-note-title')\n\n      let titleBBox = { height: 0 }\n      const label = this.a.select('text.annotation-note-label')\n      const wrapLength = this.annotation.note && this.annotation.note.wrap || \n        this.typeSettings && this.typeSettings.note && this.typeSettings.note.wrap ||\n        this.textWrap \n\n      if (this.annotation.note.title){\n        const title = this.a.select('text.annotation-note-title')\n        title.text(this.annotation.note.title)\n          .attr('dy', '1.1em')\n        title.call(wrap, wrapLength)\n        titleBBox = title.node().getBBox()\n      }\n\n      label.text(this.annotation.note.label)\n        .attr('dy', '1em')\n      label.call(wrap, wrapLength)\n\n      label.attr('y', titleBBox.height * 1.1 || 0)\n\n      const bbox = this.getNoteBBox()\n      this.a.select('rect.annotation-note-bg')\n        .attr('width', bbox.width)\n        .attr('height', bbox.height)\n    }\n  }\n}\n\nexport const d3Label = customType(d3NoteText, {\n  className: \"label\", \n  note: { align: \"middle\"}\n})\n\nexport const d3Callout = customType(d3NoteText, {\n  className: \"callout\",\n  note: { lineType: \"horizontal\" }\n})\n\nexport const d3CalloutElbow = customType(d3Callout, {\n  className: \"callout elbow\",\n  connector: { type: \"elbow\" }\n})\n\nexport const d3CalloutCurve = customType(d3Callout, {\n  className: \"callout curve\",\n  connector: { type: \"curve\" }\n})\n\nexport const d3Badge = customType(Type, {\n  className: \"badge\",\n  subject: { type: \"badge\"},\n  disable: ['connector', 'note']\n})\n\n\nexport const d3CalloutCircle = customType(d3CalloutElbow, {\n  className: \"callout circle\",\n  subject: { type: \"circle\"}\n})\n\nexport const d3CalloutRect = customType(d3CalloutElbow, {\n  className: \"callout rect\",\n  subject: { type: \"rect\"}\n})\n\n\nclass ThresholdMap extends d3Callout {\n\n  mapY(accessors){\n    super.mapY(accessors)\n    const a = this.annotation\n    if ((a.subject.x1 || a.subject.x2) && a.data && accessors.y){\n      a.y = accessors.y(a.data)\n    }\n  }\n\n  mapX(accessors) {\n    super.mapX(accessors)\n    const a = this.annotation\n    if ((a.subject.y1 || a.subject.y2) && a.data && accessors.x){\n      a.x = accessors.x(a.data)\n    }\n  }\n}\n\nexport const d3XYThreshold = customType(ThresholdMap, {\n  className: \"callout xythreshold\",\n  subject: { type: \"threshold\"}\n})\n\n\n\nexport const newWithClass = (a, d, type, className) => {\n  const group = a.selectAll(`${type}.${className}`).data(d)\n  group.enter()\n    .append(type)\n    .merge(group)\n    .attr('class', className)\n\n  group.exit().remove()\n  return a\n}\n\n\nconst addHandlers = ( dispatcher, annotation, { component, name }) => {\n  if (component){\n    component\n    .on(\"mouseover.annotations\", () => {\n      dispatcher.call(`${name}over`, component, annotation)})\n    .on(\"mouseout.annotations\", () => dispatcher.call(`${name}out`, component, annotation))\n    .on(\"click.annotations\", () => dispatcher.call(`${name}click`, component, annotation))\n  }\n}\n\n//Text wrapping code adapted from Mike Bostock\nconst wrap = (text, width) => {\n  text.each(function() {\n    var text = select(this),\n        words = text.text().split(/[ \\t\\r\\n]+/).reverse(),\n        word,\n        line = [],\n        lineNumber = 0,\n        lineHeight = .2, //ems\n        y = text.attr(\"y\"),\n        dy = parseFloat(text.attr(\"dy\")) || 0,\n        tspan = text.text(null)\n          .append(\"tspan\")\n          .attr(\"x\", 0)\n          .attr(\"dy\", dy + \"em\");\n\n    while (word = words.pop()) {\n      line.push(word);\n      tspan.text(line.join(\" \"));\n      if (tspan.node().getComputedTextLength() > width && line.length > 1) {\n        line.pop();\n        tspan.text(line.join(\" \"));\n        line = [word];\n        tspan = text.append(\"tspan\")\n          .attr(\"x\", 0)\n          .attr(\"dy\", lineHeight + dy + \"em\").text(word);\n      }\n    }\n  });\n}\n\nconst bboxWithoutHandles = (selection, selector=':not(.handle)') => {\n  if (!selection){\n    return { x: 0, y: 0, width: 0, height: 0}\n  }\n\n  return selection.selectAll(selector).nodes().reduce((p, c) => {\n        const bbox = c.getBBox()\n        p.x = Math.min(p.x, bbox.x)\n        p.y = Math.min(p.y, bbox.y)\n        p.width = Math.max(p.width, bbox.width)\n        p.height += bbox.height\n        return p\n      }, { x: 0, y: 0, width: 0, height: 0});\n}\n\nexport default {\n  Type,\n  d3Label,\n  d3Callout,\n  d3CalloutElbow,\n  d3CalloutCurve,\n  d3CalloutCircle,\n  d3CalloutRect,\n  d3XYThreshold,\n  d3Badge,\n  customType\n}\n","import Annotation from './Annotation'\nimport AnnotationCollection from './AnnotationCollection'\nimport { newWithClass, d3Callout } from './Types-d3'\nimport { select } from 'd3-selection'\nimport { dispatch } from 'd3-dispatch';\n\n\nexport default function annotation(){\n  let annotations = [],\n    collection,\n    context, //TODO: add canvas functionality\n    disable = [],\n    accessors = {},\n    accessorsInverse = {},\n    editMode = false,\n    ids,\n    type = d3Callout,\n    textWrap,\n    notePadding,\n    annotationDispatcher = dispatch(\n    \"subjectover\", \"subjectout\", \"subjectclick\", \n    \"connectorover\", \"connectorout\", \"connectorclick\", \n    \"noteover\", \"noteout\", \"noteclick\"),\n    sel;\n\n  const annotation = function(selection){\n    sel = selection\n    //TODO: check to see if this is still needed    \n    if (!editMode){\n      selection.selectAll(\"circle.handle\")\n        .remove()\n    }\n\n    const translatedAnnotations = annotations\n      .map(a => {\n        if (!a.type) { a.type = type }\n        if (!a.disable) {a.disable = disable}\n        return new Annotation(a)\n      });\n\n    collection = new AnnotationCollection ({\n      annotations: translatedAnnotations,\n      accessors,\n      accessorsInverse,\n      ids\n    })\n    \n\n    const annotationG = selection.selectAll('g').data([collection])\n    annotationG.enter().append('g').attr('class', `annotations`)\n    \n    const group = selection.select('g.annotations')\n    newWithClass(group, collection.annotations, 'g', 'annotation')\n\n    const annotation = group.selectAll('g.annotation')\n    \n    annotation \n      .each(function(d) {\n        const a = select(this)\n        const position = d.position\n\n        a.attr('class', 'annotation')\n\n        newWithClass(a, [d], 'g', 'annotation-connector')\n        newWithClass(a, [d], 'g', 'annotation-subject')\n        newWithClass(a, [d], 'g', 'annotation-note')\n        newWithClass(a.select('g.annotation-note'), [d], 'g', 'annotation-note-content')\n\n        d.type = new d.type({ a, annotation: d, textWrap, notePadding, editMode, \n          dispatcher: annotationDispatcher, accessors })\n        d.type.draw()\n      })\n  }\n\n  annotation.json = function() {\n    console.log('Annotations JSON was copied to your clipboard. Please note the annotation type is not JSON compatible. It appears in the objects array in the console, but not in the copied JSON.', collection.json)\n    window.copy(JSON.stringify(collection.json.map(a => { delete a.type; return a })))\n    return annotation\n  }\n\n  annotation.update = function(){\n    if (annotations && collection){\n      annotations = collection.annotations.map((a, i) => { a.type.draw(); return a }) \n    }\n    return annotation\n  }\n\n  annotation.updatedAccessors = function(){\n    collection.setPositionWithAccessors()\n    annotations = collection.annotations\n    return annotation\n  }\n\n  annotation.disable = function(_){\n    if (!arguments.length) return disable;\n    disable = _\n    if (collection) { \n      collection.updateDisable(disable)\n      annotations = collection.annotations\n    }\n    return annotation;\n  }\n\n  annotation.textWrap = function(_){\n    if (!arguments.length) return textWrap;\n    textWrap = _\n    if (collection) { \n      collection.updateTextWrap(textWrap)\n      annotations = collection.annotations\n    }\n    return annotation;\n  }\n\n  annotation.notePadding = function(_){\n    if (!arguments.length) return notePadding;\n    notePadding = _\n    if (collection) { \n      collection.updateNotePadding(notePadding)\n      annotations = collection.annotations\n    }\n    return annotation;\n  }\n\n  annotation.type = function(_, settings) {\n    if (!arguments.length) return type;\n    type = _;\n    if (collection) { \n      collection.annotations.map(a => {\n     \n        a.type.note && a.type.note.selectAll(\"*:not(.annotation-note-content)\").remove()\n        a.type.noteContent && a.type.noteContent.selectAll(\"*\").remove()\n        a.type.subject && a.type.subject.selectAll(\"*\").remove()\n        a.type.connector && a.type.connector.selectAll(\"*\").remove()\n        a.type.typeSettings = {}\n        a.type = type\n\n        a.subject = settings && settings.subject || a.subject\n        a.connector = settings && settings.connector || a.connector\n        a.note = settings && settings.note || a.note\n      })\n\n      annotations = collection.annotations\n    }\n    return annotation;\n  }\n\n  annotation.annotations = function(_) {\n    if (!arguments.length) return collection && collection.annotations || annotations;\n    annotations = _\n    return annotation;\n  };\n\n  annotation.context = function(_) {\n    if (!arguments.length) return context;\n    context = _\n    return annotation;\n  }; \n\n  annotation.accessors = function(_) {\n    if (!arguments.length) return accessors;\n    accessors = _;\n    return annotation\n  }\n\n  annotation.accessorsInverse = function(_) {\n    if (!arguments.length) return accessorsInverse;\n    accessorsInverse = _;\n    return annotation\n  }\n\n  annotation.ids = function(_) {\n    if (!arguments.length) return ids;\n    ids = _;\n    return annotation\n  }\n\n  annotation.editMode = function(_) {\n    if (!arguments.length) return editMode;\n    editMode = _\n\n    if (sel){\n      sel.selectAll('g.annotation')\n        .classed('editable', editMode)\n    }\n\n    if (collection) { \n      collection.editMode(editMode)\n      annotations = collection.annotations\n    }\n    return annotation\n  }\n\n  annotation.collection = function(_) {\n    if (!arguments.length) return collection;\n    collection = _\n    return annotation\n  }\n\n  annotation.on = function(){\n    const value = annotationDispatcher.on.apply(annotationDispatcher, arguments)\n    return value === annotationDispatcher ? annotation : value;\n  }\n\n  return annotation;\n\n};","import annotation from './src/Adapter-d3'\nimport { Type, d3Label, d3Callout, d3CalloutCurve, d3CalloutElbow, d3CalloutCircle, \n d3CalloutRect, d3XYThreshold, d3Badge, customType } from './src/Types-d3'\n\nexport {\n  annotation,\n  Type as annotationTypeBase ,\n  d3Label as annotationLabel ,\n  d3Callout as annotationCallout ,\n  d3CalloutCurve as annotationCalloutCurve ,\n  d3CalloutElbow as annotationCalloutElbow ,\n  d3CalloutCircle as annotationCalloutCircle ,\n  d3CalloutRect as annotationCalloutRect ,\n  d3XYThreshold as annotationXYThreshold ,\n  d3Badge as annotationBadge ,\n  customType as annotationCustomType \n}\n\nexport default {\n  annotation,\n  annotationTypeBase : Type,\n  annotationLabel : d3Label,\n  annotationCallout : d3Callout,\n  annotationCalloutCurve : d3CalloutCurve,\n  annotationCalloutElbow : d3CalloutElbow,\n  annotationCalloutCircle : d3CalloutCircle,\n  annotationCalloutRect : d3CalloutRect,\n  annotationXYThreshold : d3XYThreshold,\n  annotationBadge : d3Badge,\n  annotationCustomType : customType\n}"],"names":["Annotation","x","y","dy","dx","data","type","subject","connector","note","disable","id","className","_dx","_dy","_x","_y","_className","setPosition","selectAll","nodes","length","redrawSubject","setOffset","redrawConnector","redrawNote","setClassName","updatePosition","updateOffset","json","Object","keys","AnnotationCollection","annotations","accessors","accessorsInverse","newSettings","forEach","undefined","d","setPositionWithAccessors","editMode","a","updateEditMode","remove","textWrap","updateTextWrap","notePadding","map","k","getNoteBBoxOffset","positionX","positionY","pointHandle","cx","cy","move","circleHandles","r1","r2","padding","h","Math","sqrt","addHandles","group","handles","r","enter","append","attr","call","drag","container","select","node","on","start","end","exit","leftRightDynamic","align","topBottomDynamic","bbox","orientation","offset","height","width","lineBuilder","curve","curveLinear","canvasContext","lineGen","line","builder","context","pathMethods","attrs","arcBuilder","arcShape","arc","innerRadius","outerRadius","radius","startAngle","endAngle","PI","components","lineSetup","subjectType","annotation","position","x1","x2","y1","y2","subjectData","angle","asin","radiusPadding","abs","cos","sin","connectorData","diffY","diffX","xe","ye","opposite","acos","points","createPoints","curveCatmullRom","cHandles","c","i","index","updatePoint","event","mapHandles","bind","anchors","diff","p","push","size","angleOffset","atan","dot","transform","updateRadius","rect","updateWidth","updateHeight","rHandles","circlebg","circle","pointer","dragBadge","bHandles","text","Type","dispatcher","indexOf","noteContent","handler","addHandlers","component","name","offsetCornerX","offsetCornerY","init","mapX","mapY","builders","Array","isArray","filter","b","el","attrKeys","bboxWithoutHandles","split","parseFloat","offsetX","offsetY","subjectParams","subjectCircle","subjectRect","subjectThreshold","subjectBadge","concat","dragSubject","connectorParams","typeSettings","connectorCurve","connectorElbow","connectorLine","endType","s","e","distance","pow","connectorArrow","connectorDot","noteData","noteParams","lineType","noteVertical","noteHorizontal","dragNote","noteAlignment","drawFunction","drawOnSVG","drawOnScreen","drawSubject","getNoteBBox","drawConnector","drawNoteContent","drawNote","sourceEvent","stopPropagation","classed","style","dragstarted","dragended","customType","initialType","settings","babelHelpers.get","assign","subjectContext","d3NoteText","params","drawText","titleBBox","label","wrapLength","wrap","title","getBBox","d3Label","d3Callout","d3CalloutElbow","d3CalloutCurve","d3Badge","d3CalloutCircle","d3CalloutRect","ThresholdMap","d3XYThreshold","newWithClass","merge","each","words","reverse","word","lineNumber","lineHeight","tspan","pop","join","getComputedTextLength","selection","selector","reduce","min","max","collection","ids","annotationDispatcher","dispatch","sel","translatedAnnotations","annotationG","draw","log","copy","JSON","stringify","update","updatedAccessors","_","arguments","updateDisable","updateNotePadding","value","apply"],"mappings":"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"}